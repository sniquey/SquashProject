<p id="notice"><%= notice %></p>

<h1>Listing matches</h1>

<table>
  <thead>
    <tr>
      <th>Player</th>
      <th>Opponent</th>
      <th>Date</th>
      <th>Result</th>
      <th>Games</th>
    <th>Points</th>
      <th></th>
      <th colspan="7"></th>
    </tr>
  </thead>

  <tbody>
  	 <% @player.matches.each do |match| %>
        <% if match.winner_id == @player.id %>
        <% @opponent = nil unless @opponent = Player.find_by(:id => match.loser_id) %>
          <tr> 
            <td> <%= @player.name %></td>
            <%# if @opponent? %>
            <td><%#= @opponent.name %></td>		
            <%# else %>
            <td><%= loser_id %> </td>
            <%# end %>
            <td><%= match.date %></td>
            <td>1</td>
            <td>
              <table>
          		  <tr>
          			 <td><%= match.winner_games %>: </td>
          			 <td><%= match.loser_games %></td>
  				      </tr>
          	 </table>
      	   </td>
      	   <td>
            <table>
          		<tr>
          			<td><%= match.winner_points %>: </td>
          			<td><%= match.loser_points %></td>
  				    </tr>
          	</table>
      	   </td>
          <td><%= link_to 'Edit', edit_match_path(match) %></td>
        </tr>
      <% elsif match.loser_id == @player.id %>
      <% @opponent = nil unless @opponent = Player.find_by(:id => match.winner_id) %>
        <tr> 
          <td><%= @player.name %></td>
           <%# if @opponent? %>
          <td><%#= @opponent.name %></td> 
            <%# else %>
            <td><%= winner_id %> </td>
            <%# end %>
          <td><%= match.date %></td>

          <td>0</td>
          <td>
            <table>
              <tr>
                <td><%= match.loser_games %>: </td>
                <td><%= match.winner_games %></td>
              </tr>
            </table>
          </td>
          <td>  
            <table>
              <tr>
                <td><%= match.loser_points %>: </td>
                <td><%= match.winner_points %></td>
              </tr>
            </table>
          </td>
          <td><%= link_to 'Edit', edit_match_path(match) %></td>
        </tr>
  		<% end %>
    <% end %>

  </tbody>
</table>

<br>

